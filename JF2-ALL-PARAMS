pipeline {
    agent any 

    parameters {
        string(name: 'USERNAME', defaultValue: 'Izhan', description: 'Enter your Name')
        choice(name: 'ENV', choices: ['Dev', 'Staging', 'Deploy'], description: 'Choose a branch')
        booleanParam(name: 'Do_Deploy', defaultValue: false, description: 'Should we deploy after build?')
        /* password(name: 'SECRET', defaultValue: '', description: 'Enter your Password')
        text(name: 'NOTES', defaultValue: 'Enter your notes here', description: 'Any additional notes you want to add') */
    }

    stages {
        stage('Enter Parameters') {
            steps {
                echo "Username: ${params.USERNAME}"
                echo "ENV: ${params.ENV}"
                echo "Do_Deploy: ${params.Do_Deploy}"
                /* echo "SECRET: ${params.SECRET}"  // Avoid printing passwords in real pipelines
                echo "NOTES: ${params.NOTES}" */
            }
        }

        stage('Conditional Deploy') {
            when {
                expression { params.Do_Deploy }
            }
            steps {
                echo "Deploying as ${params.USERNAME} on ${params.ENV}"
                sh "mkdir -p Deployments-${params.ENV}"
                sh "echo 'deployed by ${params.USERNAME} on ${params.ENV}' > Deployments-${params.ENV}/deployment.txt"
                sh "cat Deployments-${params.ENV}/deployment.txt"
            }
        }

        stage('Skipped Deploy') {
            when {
                expression { !params.Do_Deploy }
            }
            steps {
                echo "${params.USERNAME} chose not to deploy on ${params.ENV} environment"
            }
        }
    }
}
